"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8874],{8146:function(e,t,n){n.d(t,{Z:function(){return r}});let r=(0,n(8322).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},9578:function(e,t,n){n.d(t,{Z:function(){return r}});let r=(0,n(8322).Z)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},4275:function(e,t,n){n.d(t,{Z:function(){return r}});let r=(0,n(8322).Z)("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]])},8575:function(e,t,n){n.d(t,{Z:function(){return r}});let r=(0,n(8322).Z)("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]])},6744:function(e,t,n){n.d(t,{Z:function(){return r}});let r=(0,n(8322).Z)("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]])},5805:function(e,t,n){n.d(t,{Z:function(){return r}});let r=(0,n(8322).Z)("Stethoscope",[["path",{d:"M4.8 2.3A.3.3 0 1 0 5 2H4a2 2 0 0 0-2 2v5a6 6 0 0 0 6 6v0a6 6 0 0 0 6-6V4a2 2 0 0 0-2-2h-1a.2.2 0 1 0 .3.3",key:"1jd90r"}],["path",{d:"M8 15v1a6 6 0 0 0 6 6v0a6 6 0 0 0 6-6v-4",key:"126ukv"}],["circle",{cx:"20",cy:"10",r:"2",key:"ts1r5v"}]])},1569:function(e,t,n){n.d(t,{Z:function(){return w}});var r=n(7821),a=n(8078),s=n(3116),l=n(4811),o=n(4275),i=n(20),c=n(2531),d=n(2828),u=n(8146),m=n(9578);function f(e){let{length:t=6,value:n,onChange:s,onComplete:l,disabled:o=!1,error:i=!1,autoFocus:c=!0}=e,[d,u]=(0,a.useState)(0),m=(0,a.useRef)([]);(0,a.useEffect)(()=>{m.current=m.current.slice(0,t)},[t]),(0,a.useEffect)(()=>{c&&m.current[0]&&m.current[0].focus()},[c]),(0,a.useEffect)(()=>{let e=n.length;if(e<t&&m.current[e]){var r;null===(r=m.current[e])||void 0===r||r.focus(),u(e)}},[n,t]);let f=(e,r)=>{if(o)return;let a=r.replace(/\D/g,"").slice(-1);if(a){let r=n.slice(0,e)+a+n.slice(e+1);if(s(r.slice(0,t)),e<t-1&&m.current[e+1]){var i;null===(i=m.current[e+1])||void 0===i||i.focus(),u(e+1)}r.length===t&&l&&l(r)}},g=(e,r)=>{var a,l,i;!o&&("Backspace"===r.key?(r.preventDefault(),n[e]?s(n.slice(0,e)+n.slice(e+1)):e>0&&(s(n.slice(0,e-1)+n.slice(e)),null===(a=m.current[e-1])||void 0===a||a.focus(),u(e-1))):"ArrowLeft"===r.key&&e>0?(null===(l=m.current[e-1])||void 0===l||l.focus(),u(e-1)):"ArrowRight"===r.key&&e<t-1&&(null===(i=m.current[e+1])||void 0===i||i.focus(),u(e+1)))},h=e=>{if(o)return;e.preventDefault();let n=e.clipboardData.getData("text").replace(/\D/g,"").slice(0,t);if(n){var r;s(n);let e=Math.min(n.length,t-1);null===(r=m.current[e])||void 0===r||r.focus(),u(e),n.length===t&&l&&l(n)}},x=e=>{var t;u(e),null===(t=m.current[e])||void 0===t||t.select()};return(0,r.jsx)("div",{className:"flex gap-2 sm:gap-3 justify-center",children:Array.from({length:t},(e,a)=>(0,r.jsx)("input",{ref:e=>{m.current[a]=e},type:"text",inputMode:"numeric",pattern:"[0-9]*",maxLength:1,value:n[a]||"",onChange:e=>f(a,e.target.value),onKeyDown:e=>g(a,e),onPaste:h,onFocus:()=>x(a),disabled:o,className:"\n            w-10 h-12 sm:w-12 sm:h-14 md:w-14 md:h-16\n            text-center text-xl sm:text-2xl font-bold\n            border-2 rounded-xl\n            transition-all duration-200\n            focus:outline-none\n            ".concat(o?"bg-gray-100 text-gray-400 border-gray-200 cursor-not-allowed":i?"border-red-300 bg-red-50 text-red-600 focus:border-red-500 focus:ring-2 focus:ring-red-200":n[a]?"border-emerald-400 bg-emerald-50 text-emerald-700 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-200":d===a?"border-sky-500 bg-white text-gray-900 ring-2 ring-sky-200":"border-gray-200 bg-white text-gray-900 hover:border-gray-300 focus:border-sky-500 focus:ring-2 focus:ring-sky-200","\n          "),"aria-label":"Digit ".concat(a+1," of ").concat(t)},a))})}var g=n(3020);let h={length:6,expiryMinutes:5,maxAttempts:3,resendCooldownSeconds:30,demoMode:!0,demoOTP:"123456"};function x(e){if(e.length<6)return e;let t=e.slice(0,4),n=e.slice(-2),r="*".repeat(e.length-6);return"".concat(t).concat(r).concat(n)}function p(e){let[t,n]=e.split("@");if(!n)return e;if(t.length<=2)return"".concat(t,"***@").concat(n);let r=t.slice(0,2),a=t.slice(-1);return"".concat(r,"***").concat(a,"@").concat(n)}async function y(e,t){return(await new Promise(e=>setTimeout(e,1e3)),h.demoMode)?(console.log("[DEMO] OTP ".concat(t," sent to ").concat(e)),{success:!0,message:"OTP sent to ".concat(x(e),". Demo OTP: ").concat(h.demoOTP)}):{success:!0,message:"OTP sent to ".concat(x(e))}}async function v(e,t){return(await new Promise(e=>setTimeout(e,1e3)),h.demoMode)?(console.log("[DEMO] OTP ".concat(t," sent to ").concat(e)),{success:!0,message:"OTP sent to ".concat(p(e),". Demo OTP: ").concat(h.demoOTP)}):{success:!0,message:"OTP sent to ".concat(p(e))}}let b=(0,g.Ue)((e,t)=>({currentOTP:null,isLoading:!1,isSending:!1,isVerifying:!1,error:null,successMessage:null,resendCooldown:0,canResend:!0,sendOTP:async(n,r,a)=>{e({isSending:!0,error:null,successMessage:null});try{let s=function(e,t,n){let r=Date.now();return{otp:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h.length;if(h.demoMode)return h.demoOTP;let t="";for(let n=0;n<e;n++)t+=Math.floor(10*Math.random()).toString();return t}(),phone:"sms"===e?t:void 0,email:"email"===e?t:void 0,channel:e,createdAt:r,expiresAt:r+6e4*h.expiryMinutes,attempts:0,verified:!1,purpose:n}}(n,r,a),l="email"===n?await v(r,s.otp):await y(r,s.otp);if(l.success)return e({currentOTP:s,isSending:!1,successMessage:l.message,canResend:!1}),t().startResendCooldown(),!0;return e({isSending:!1,error:l.message}),!1}catch(t){return e({isSending:!1,error:"Failed to send OTP. Please try again."}),!1}},verifyOTP:async n=>{var r,a;let{currentOTP:s}=t();if(!s)return e({error:"No OTP request found. Please request a new OTP."}),!1;e({isVerifying:!0,error:null}),await new Promise(e=>setTimeout(e,500)),t().incrementAttempts();let l=(r=n,(a=s).verified?{valid:!1,error:"OTP already used"}:Date.now()>a.expiresAt?{valid:!1,error:"OTP has expired. Please request a new one."}:a.attempts>=h.maxAttempts?{valid:!1,error:"Too many attempts. Please request a new OTP."}:r===a.otp?{valid:!0}:{valid:!1,error:"Invalid OTP. Please try again."});return l.valid?(e({currentOTP:{...s,verified:!0},isVerifying:!1,successMessage:"OTP verified successfully!"}),!0):(e({isVerifying:!1,error:l.error||"Invalid OTP"}),!1)},resendOTP:async()=>{let{currentOTP:n,canResend:r}=t();if(!r)return e({error:"Please wait before requesting a new OTP"}),!1;if(!n)return e({error:"No previous OTP request found"}),!1;let a="email"===n.channel?n.email:n.phone;return t().sendOTP(n.channel,a,n.purpose)},incrementAttempts:()=>{let{currentOTP:n}=t();n&&e({currentOTP:{...n,attempts:n.attempts+1}})},clearOTP:()=>{e({currentOTP:null,error:null,successMessage:null,isLoading:!1,isSending:!1,isVerifying:!1})},clearError:()=>{e({error:null})},startResendCooldown:()=>{e({resendCooldown:h.resendCooldownSeconds,canResend:!1});let n=setInterval(()=>{let{resendCooldown:r}=t();r<=1?(clearInterval(n),e({resendCooldown:0,canResend:!0})):e({resendCooldown:r-1})},1e3)}}));function w(e){let{isOpen:t,onClose:n,onSuccess:g,phone:y,email:v,channel:w,purpose:T,title:j,subtitle:N}=e,[k,O]=(0,a.useState)(""),[P,M]=(0,a.useState)(""),{currentOTP:S,isSending:A,isVerifying:D,error:E,successMessage:C,resendCooldown:Z,canResend:_,sendOTP:R,verifyOTP:I,resendOTP:U,clearError:L,clearOTP:F}=b(),V="email"===w?v:y,q=j||("email"===w?"Verify Your Email":"Verify Your Phone"),W=N||"Enter the ".concat(h.length,"-digit code sent to your ").concat("email"===w?"email":"phone");(0,a.useEffect)(()=>{t&&!S&&R(w,V,T)},[t,w,V,T,S,R]),(0,a.useEffect)(()=>{if(!S)return;let e=setInterval(()=>{M(function(e){let{minutes:t,seconds:n}=function(e){let t=Math.max(0,e-Date.now());return{minutes:Math.floor(t/6e4),seconds:Math.floor(t%6e4/1e3)}}(e);return"".concat(t,":").concat(n.toString().padStart(2,"0"))}(S.expiresAt))},1e3);return()=>clearInterval(e)},[S]);let B=()=>{O(""),F(),n()},J=async e=>{await I(e)&&setTimeout(()=>{g(),B()},1500)},z=async()=>{k.length===h.length&&await J(k)},K=async()=>{O(""),L(),await U()};if(!t)return null;let X=null==S?void 0:S.verified;return(0,r.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:B}),(0,r.jsxs)("div",{className:"relative w-full max-w-md bg-white rounded-2xl shadow-2xl overflow-hidden animate-in fade-in zoom-in-95 duration-200",children:[(0,r.jsxs)("div",{className:"relative bg-gradient-to-r from-sky-500 to-emerald-500 px-6 py-8 text-white",children:[(0,r.jsx)("button",{onClick:B,className:"absolute top-4 right-4 p-2 rounded-full bg-white/20 hover:bg-white/30 transition-colors",children:(0,r.jsx)(s.Z,{className:"w-5 h-5"})}),(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("div",{className:"w-16 h-16 bg-white/20 rounded-2xl flex items-center justify-center",children:"email"===w?(0,r.jsx)(l.Z,{className:"w-8 h-8"}):(0,r.jsx)(o.Z,{className:"w-8 h-8"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-2xl font-bold",children:q}),(0,r.jsx)("p",{className:"text-white/80 text-sm mt-1",children:W})]})]})]}),(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsx)("div",{className:"flex items-center justify-center gap-2 mb-6 py-3 bg-gray-50 rounded-xl",children:"email"===w?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.Z,{className:"w-5 h-5 text-gray-500"}),(0,r.jsx)("span",{className:"text-gray-700 font-medium",children:p(v)})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.Z,{className:"w-5 h-5 text-gray-500"}),(0,r.jsx)("span",{className:"text-gray-700 font-medium",children:x(y)})]})}),X?(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsx)("div",{className:"w-20 h-20 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,r.jsx)(c.Z,{className:"w-10 h-10 text-emerald-600"})}),(0,r.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Verified Successfully!"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Redirecting you..."})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsx)(f,{value:k,onChange:e=>{O(e),E&&L()},onComplete:J,disabled:A||D,error:!!E,autoFocus:!0})}),E&&(0,r.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-red-50 border border-red-200 rounded-xl mb-4",children:[(0,r.jsx)(d.Z,{className:"w-5 h-5 text-red-500 flex-shrink-0"}),(0,r.jsx)("p",{className:"text-red-600 text-sm",children:E})]}),C&&!E&&(0,r.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-emerald-50 border border-emerald-200 rounded-xl mb-4",children:[(0,r.jsx)(c.Z,{className:"w-5 h-5 text-emerald-500 flex-shrink-0"}),(0,r.jsx)("p",{className:"text-emerald-600 text-sm",children:C})]}),S&&(0,r.jsx)("div",{className:"text-center mb-4",children:(0,r.jsxs)("p",{className:"text-sm text-gray-500",children:["Code expires in"," ",(0,r.jsx)("span",{className:"font-semibold text-gray-700",children:P})]})}),h.demoMode&&(0,r.jsx)("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-3 mb-4",children:(0,r.jsxs)("p",{className:"text-amber-700 text-sm text-center",children:["\uD83D\uDD10 Demo Mode: Use OTP ",(0,r.jsx)("span",{className:"font-bold",children:h.demoOTP})]})}),(0,r.jsx)("button",{onClick:z,disabled:k.length!==h.length||D||A,className:"\n                  w-full py-3.5 rounded-xl font-semibold text-white\n                  flex items-center justify-center gap-2\n                  transition-all duration-200\n                  ".concat(k.length!==h.length||D||A?"bg-gray-300 cursor-not-allowed":"bg-gradient-to-r from-sky-500 to-emerald-500 hover:from-sky-600 hover:to-emerald-600 shadow-lg hover:shadow-xl","\n                "),children:D?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u.Z,{className:"w-5 h-5 animate-spin"}),"Verifying..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(c.Z,{className:"w-5 h-5"}),"Verify OTP"]})}),(0,r.jsxs)("div",{className:"mt-6 text-center",children:[(0,r.jsx)("p",{className:"text-sm text-gray-500 mb-2",children:"Didn't receive the code?"}),(0,r.jsx)("button",{onClick:K,disabled:!_||A,className:"\n                    inline-flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium\n                    transition-all duration-200\n                    ".concat(_&&!A?"text-sky-600 hover:bg-sky-50":"text-gray-400 cursor-not-allowed","\n                  "),children:A?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u.Z,{className:"w-4 h-4 animate-spin"}),"Sending..."]}):_?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(m.Z,{className:"w-4 h-4"}),"Resend OTP"]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(m.Z,{className:"w-4 h-4"}),"Resend in ",Z,"s"]})})]})]})]})]})]})}},9557:function(e,t,n){n.d(t,{Bw:function(){return v},Dn:function(){return s},EY:function(){return f},H3:function(){return c},L:function(){return h},N1:function(){return o},Sv:function(){return g},o:function(){return i},of:function(){return p},sp:function(){return l},tk:function(){return d},yD:function(){return x}});let r=new Map,a={MAX_ATTEMPTS:5,WINDOW_MS:9e5,BLOCK_DURATION_MS:18e5,OTP_MAX_REQUESTS:3,OTP_WINDOW_MS:6e5};function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"login",n=Date.now(),s=r.get("".concat(t,":").concat(e)),l="otp"===t?a.OTP_MAX_REQUESTS:a.MAX_ATTEMPTS,o="otp"===t?a.OTP_WINDOW_MS:a.WINDOW_MS;if(!s)return r.set("".concat(t,":").concat(e),{count:1,firstAttempt:n,lastAttempt:n,blocked:!1,blockedUntil:0}),{allowed:!0,remainingAttempts:l-1};if(s.blocked&&s.blockedUntil>n){let e=Math.ceil((s.blockedUntil-n)/6e4);return{allowed:!1,remainingAttempts:0,blockedUntil:s.blockedUntil,message:"Too many attempts. Try again in ".concat(e," minutes.")}}if(n-s.firstAttempt>o||s.blocked&&s.blockedUntil<=n)return r.set("".concat(t,":").concat(e),{count:1,firstAttempt:n,lastAttempt:n,blocked:!1,blockedUntil:0}),{allowed:!0,remainingAttempts:l-1};if(s.count++,s.lastAttempt=n,s.count>=l){s.blocked=!0,s.blockedUntil=n+a.BLOCK_DURATION_MS,r.set("".concat(t,":").concat(e),s);let l=Math.ceil(a.BLOCK_DURATION_MS/6e4);return{allowed:!1,remainingAttempts:0,blockedUntil:s.blockedUntil,message:"Too many attempts. Account locked for ".concat(l," minutes.")}}return r.set("".concat(t,":").concat(e),s),{allowed:!0,remainingAttempts:l-s.count}}function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"login";r.delete("".concat(t,":").concat(e))}function o(e){return e?e.trim().replace(/<[^>]*>/g,"").replace(/[&<>"']/g,e=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"})[e]||e).replace(/(\b(SELECT|INSERT|UPDATE|DELETE|DROP|UNION|ALTER|CREATE|TRUNCATE)\b)/gi,"").replace(/(javascript:|data:|vbscript:)/gi,""):""}function i(e){return e.replace(/\D/g,"")}function c(e){return e?e.trim().toLowerCase():""}function d(){let e=new Uint8Array(32);if(window.crypto)window.crypto.getRandomValues(e);else for(let t=0;t<e.length;t++)e[t]=Math.floor(256*Math.random());return Array.from(e,e=>e.toString(16).padStart(2,"0")).join("")}function u(){var e;let t=[navigator.userAgent,navigator.language,screen.width+"x"+screen.height,Intl.DateTimeFormat().resolvedOptions().timeZone,(null===(e=navigator.hardwareConcurrency)||void 0===e?void 0:e.toString())||"unknown"],n=0,r=t.join("|");for(let e=0;e<r.length;e++)n=(n<<5)-n+r.charCodeAt(e),n&=n;return"device_"+Math.abs(n).toString(36)}let m="sangman_remembered_credentials";function f(e){let t=u(),n=g().filter(t=>!(t.type===e.type&&t.fullValue===e.fullValue)),r=[{...e,deviceFingerprint:t,lastLogin:Date.now()},...n].slice(0,3);try{localStorage.setItem(m,JSON.stringify(r))}catch(e){console.error("Failed to save remembered credential:",e)}}function g(){try{let e=localStorage.getItem(m);if(!e)return[];let t=JSON.parse(e),n=u();return t.filter(e=>e.deviceFingerprint===n)}catch(e){return console.error("Failed to get remembered credentials:",e),[]}}function h(e){let t=g().filter(t=>t.fullValue!==e);try{localStorage.setItem(m,JSON.stringify(t))}catch(e){console.error("Failed to remove remembered credential:",e)}}function x(e){if(!e||e.length<6)return e;let t=e.slice(-4);return e.slice(0,-4).replace(/\d/g,"*")+t}function p(e){if(!e||!e.includes("@"))return e;let[t,n]=e.split("@");if(t.length<=2)return e;let r=t.slice(0,2)+"*".repeat(Math.min(t.length-2,5));return"".concat(r,"@").concat(n)}let y="sangman_login_attempts";function v(e){try{let t=localStorage.getItem(y),n=t?JSON.parse(t):[],r=[{...e,timestamp:Date.now(),deviceFingerprint:u()},...n].slice(0,20);localStorage.setItem(y,JSON.stringify(r))}catch(e){console.error("Failed to record login attempt:",e)}}}}]);