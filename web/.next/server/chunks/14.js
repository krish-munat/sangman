exports.id=14,exports.ids=[14],exports.modules={7259:(e,t,r)=>{Promise.resolve().then(r.bind(r,3823))},4995:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});let n=(0,r(4516).Z)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},1963:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});let n=(0,r(4516).Z)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},3227:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});let n=(0,r(4516).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},2188:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});let n=(0,r(4516).Z)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]])},5517:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});let n=(0,r(4516).Z)("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]])},1286:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});let n=(0,r(4516).Z)("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]])},6223:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});let n=(0,r(4516).Z)("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]])},1652:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});let n=(0,r(4516).Z)("Stethoscope",[["path",{d:"M4.8 2.3A.3.3 0 1 0 5 2H4a2 2 0 0 0-2 2v5a6 6 0 0 0 6 6v0a6 6 0 0 0 6-6V4a2 2 0 0 0-2-2h-1a.2.2 0 1 0 .3.3",key:"1jd90r"}],["path",{d:"M8 15v1a6 6 0 0 0 6 6v0a6 6 0 0 0 6-6v-4",key:"126ukv"}],["circle",{cx:"20",cy:"10",r:"2",key:"ts1r5v"}]])},1614:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});let n=(0,r(4516).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},8449:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});let n=(0,r(4516).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},3823:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});var n=r(9899);function s({reset:e}){return n.jsx("div",{className:"min-h-screen flex items-center justify-center bg-sky-50 p-4",children:(0,n.jsxs)("div",{className:"text-center bg-white p-8 rounded-2xl shadow-lg",children:[n.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Authentication Error"}),n.jsx("button",{onClick:()=>e(),className:"px-6 py-2 bg-sky-500 text-white rounded-lg hover:bg-sky-600",children:"Try again"})]})})}},7640:(e,t,r)=>{"use strict";r.d(t,{Z:()=>v});var n=r(9899),s=r(5507),a=r(8449),l=r(8776),i=r(5517),o=r(2188),d=r(856),c=r(4995),u=r(3227),m=r(6942);function g({length:e=6,value:t,onChange:r,onComplete:a,disabled:l=!1,error:i=!1,autoFocus:o=!0}){let[d,c]=(0,s.useState)(0),u=(0,s.useRef)([]),m=(n,s)=>{if(l)return;let i=s.replace(/\D/g,"").slice(-1);if(i){let s=t.slice(0,n)+i+t.slice(n+1);r(s.slice(0,e)),n<e-1&&u.current[n+1]&&(u.current[n+1]?.focus(),c(n+1)),s.length===e&&a&&a(s)}},g=(n,s)=>{!l&&("Backspace"===s.key?(s.preventDefault(),t[n]?r(t.slice(0,n)+t.slice(n+1)):n>0&&(r(t.slice(0,n-1)+t.slice(n)),u.current[n-1]?.focus(),c(n-1))):"ArrowLeft"===s.key&&n>0?(u.current[n-1]?.focus(),c(n-1)):"ArrowRight"===s.key&&n<e-1&&(u.current[n+1]?.focus(),c(n+1)))},h=t=>{if(l)return;t.preventDefault();let n=t.clipboardData.getData("text").replace(/\D/g,"").slice(0,e);if(n){r(n);let t=Math.min(n.length,e-1);u.current[t]?.focus(),c(t),n.length===e&&a&&a(n)}},x=e=>{c(e),u.current[e]?.select()};return n.jsx("div",{className:"flex gap-2 sm:gap-3 justify-center",children:Array.from({length:e},(r,s)=>n.jsx("input",{ref:e=>{u.current[s]=e},type:"text",inputMode:"numeric",pattern:"[0-9]*",maxLength:1,value:t[s]||"",onChange:e=>m(s,e.target.value),onKeyDown:e=>g(s,e),onPaste:h,onFocus:()=>x(s),disabled:l,className:`
            w-10 h-12 sm:w-12 sm:h-14 md:w-14 md:h-16
            text-center text-xl sm:text-2xl font-bold
            border-2 rounded-xl
            transition-all duration-200
            focus:outline-none
            ${l?"bg-gray-100 text-gray-400 border-gray-200 cursor-not-allowed":i?"border-red-300 bg-red-50 text-red-600 focus:border-red-500 focus:ring-2 focus:ring-red-200":t[s]?"border-emerald-400 bg-emerald-50 text-emerald-700 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-200":d===s?"border-sky-500 bg-white text-gray-900 ring-2 ring-sky-200":"border-gray-200 bg-white text-gray-900 hover:border-gray-300 focus:border-sky-500 focus:ring-2 focus:ring-sky-200"}
          `,"aria-label":`Digit ${s+1} of ${e}`},s))})}var h=r(4978);let x={length:6,expiryMinutes:5,maxAttempts:3,resendCooldownSeconds:30,demoMode:!0,demoOTP:"123456"};function f(e){if(e.length<6)return e;let t=e.slice(0,4),r=e.slice(-2),n="*".repeat(e.length-6);return`${t}${n}${r}`}function p(e){let[t,r]=e.split("@");if(!r)return e;if(t.length<=2)return`${t}***@${r}`;let n=t.slice(0,2),s=t.slice(-1);return`${n}***${s}@${r}`}async function y(e,t){return(await new Promise(e=>setTimeout(e,1e3)),x.demoMode)?(console.log(`[DEMO] OTP ${t} sent to ${e}`),{success:!0,message:`OTP sent to ${f(e)}. Demo OTP: ${x.demoOTP}`}):{success:!0,message:`OTP sent to ${f(e)}`}}async function b(e,t){return(await new Promise(e=>setTimeout(e,1e3)),x.demoMode)?(console.log(`[DEMO] OTP ${t} sent to ${e}`),{success:!0,message:`OTP sent to ${p(e)}. Demo OTP: ${x.demoOTP}`}):{success:!0,message:`OTP sent to ${p(e)}`}}let D=(0,h.Ue)((e,t)=>({currentOTP:null,isLoading:!1,isSending:!1,isVerifying:!1,error:null,successMessage:null,resendCooldown:0,canResend:!0,sendOTP:async(r,n,s)=>{e({isSending:!0,error:null,successMessage:null});try{let a=function(e,t,r){let n=Date.now();return{otp:function(e=x.length){if(x.demoMode)return x.demoOTP;let t="";for(let r=0;r<e;r++)t+=Math.floor(10*Math.random()).toString();return t}(),phone:"sms"===e?t:void 0,email:"email"===e?t:void 0,channel:e,createdAt:n,expiresAt:n+6e4*x.expiryMinutes,attempts:0,verified:!1,purpose:r}}(r,n,s),l="email"===r?await b(n,a.otp):await y(n,a.otp);if(l.success)return e({currentOTP:a,isSending:!1,successMessage:l.message,canResend:!1}),t().startResendCooldown(),!0;return e({isSending:!1,error:l.message}),!1}catch(t){return e({isSending:!1,error:"Failed to send OTP. Please try again."}),!1}},verifyOTP:async r=>{let{currentOTP:n}=t();if(!n)return e({error:"No OTP request found. Please request a new OTP."}),!1;e({isVerifying:!0,error:null}),await new Promise(e=>setTimeout(e,500)),t().incrementAttempts();let s=function(e,t){return t.verified?{valid:!1,error:"OTP already used"}:Date.now()>t.expiresAt?{valid:!1,error:"OTP has expired. Please request a new one."}:t.attempts>=x.maxAttempts?{valid:!1,error:"Too many attempts. Please request a new OTP."}:e===t.otp?{valid:!0}:{valid:!1,error:"Invalid OTP. Please try again."}}(r,n);return s.valid?(e({currentOTP:{...n,verified:!0},isVerifying:!1,successMessage:"OTP verified successfully!"}),!0):(e({isVerifying:!1,error:s.error||"Invalid OTP"}),!1)},resendOTP:async()=>{let{currentOTP:r,canResend:n}=t();if(!n)return e({error:"Please wait before requesting a new OTP"}),!1;if(!r)return e({error:"No previous OTP request found"}),!1;let s="email"===r.channel?r.email:r.phone;return t().sendOTP(r.channel,s,r.purpose)},incrementAttempts:()=>{let{currentOTP:r}=t();r&&e({currentOTP:{...r,attempts:r.attempts+1}})},clearOTP:()=>{e({currentOTP:null,error:null,successMessage:null,isLoading:!1,isSending:!1,isVerifying:!1})},clearError:()=>{e({error:null})},startResendCooldown:()=>{e({resendCooldown:x.resendCooldownSeconds,canResend:!1});let r=setInterval(()=>{let{resendCooldown:n}=t();n<=1?(clearInterval(r),e({resendCooldown:0,canResend:!0})):e({resendCooldown:n-1})},1e3)}}));function v({isOpen:e,onClose:t,onSuccess:r,phone:h,email:y,channel:b,purpose:v,title:j,subtitle:w}){let[k,N]=(0,s.useState)(""),[T,P]=(0,s.useState)(""),{currentOTP:C,isSending:L,isVerifying:O,error:$,successMessage:A,resendCooldown:M,canResend:S,sendOTP:E,verifyOTP:Z,resendOTP:F,clearError:U,clearOTP:R}=D(),I=w||`Enter the ${x.length}-digit code sent to your ${"email"===b?"email":"phone"}`,_=()=>{N(""),R(),t()},V=async e=>{await Z(e)&&setTimeout(()=>{r(),_()},1500)},B=async()=>{k.length===x.length&&await V(k)},q=async()=>{N(""),U(),await F()};if(!e)return null;let W=C?.verified;return(0,n.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[n.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:_}),(0,n.jsxs)("div",{className:"relative w-full max-w-md bg-white rounded-2xl shadow-2xl overflow-hidden animate-in fade-in zoom-in-95 duration-200",children:[(0,n.jsxs)("div",{className:"relative bg-gradient-to-r from-sky-500 to-emerald-500 px-6 py-8 text-white",children:[n.jsx("button",{onClick:_,className:"absolute top-4 right-4 p-2 rounded-full bg-white/20 hover:bg-white/30 transition-colors",children:n.jsx(a.Z,{className:"w-5 h-5"})}),(0,n.jsxs)("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-16 h-16 bg-white/20 rounded-2xl flex items-center justify-center",children:"email"===b?n.jsx(l.Z,{className:"w-8 h-8"}):n.jsx(i.Z,{className:"w-8 h-8"})}),(0,n.jsxs)("div",{children:[n.jsx("h2",{className:"text-2xl font-bold",children:j||("email"===b?"Verify Your Email":"Verify Your Phone")}),n.jsx("p",{className:"text-white/80 text-sm mt-1",children:I})]})]})]}),(0,n.jsxs)("div",{className:"p-6",children:[n.jsx("div",{className:"flex items-center justify-center gap-2 mb-6 py-3 bg-gray-50 rounded-xl",children:"email"===b?(0,n.jsxs)(n.Fragment,{children:[n.jsx(l.Z,{className:"w-5 h-5 text-gray-500"}),n.jsx("span",{className:"text-gray-700 font-medium",children:p(y)})]}):(0,n.jsxs)(n.Fragment,{children:[n.jsx(o.Z,{className:"w-5 h-5 text-gray-500"}),n.jsx("span",{className:"text-gray-700 font-medium",children:f(h)})]})}),W?(0,n.jsxs)("div",{className:"text-center py-8",children:[n.jsx("div",{className:"w-20 h-20 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(d.Z,{className:"w-10 h-10 text-emerald-600"})}),n.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Verified Successfully!"}),n.jsx("p",{className:"text-gray-600",children:"Redirecting you..."})]}):(0,n.jsxs)(n.Fragment,{children:[n.jsx("div",{className:"mb-6",children:n.jsx(g,{value:k,onChange:e=>{N(e),$&&U()},onComplete:V,disabled:L||O,error:!!$,autoFocus:!0})}),$&&(0,n.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-red-50 border border-red-200 rounded-xl mb-4",children:[n.jsx(c.Z,{className:"w-5 h-5 text-red-500 flex-shrink-0"}),n.jsx("p",{className:"text-red-600 text-sm",children:$})]}),A&&!$&&(0,n.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-emerald-50 border border-emerald-200 rounded-xl mb-4",children:[n.jsx(d.Z,{className:"w-5 h-5 text-emerald-500 flex-shrink-0"}),n.jsx("p",{className:"text-emerald-600 text-sm",children:A})]}),C&&n.jsx("div",{className:"text-center mb-4",children:(0,n.jsxs)("p",{className:"text-sm text-gray-500",children:["Code expires in"," ",n.jsx("span",{className:"font-semibold text-gray-700",children:T})]})}),x.demoMode&&n.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-3 mb-4",children:(0,n.jsxs)("p",{className:"text-amber-700 text-sm text-center",children:["\uD83D\uDD10 Demo Mode: Use OTP ",n.jsx("span",{className:"font-bold",children:x.demoOTP})]})}),n.jsx("button",{onClick:B,disabled:k.length!==x.length||O||L,className:`
                  w-full py-3.5 rounded-xl font-semibold text-white
                  flex items-center justify-center gap-2
                  transition-all duration-200
                  ${k.length!==x.length||O||L?"bg-gray-300 cursor-not-allowed":"bg-gradient-to-r from-sky-500 to-emerald-500 hover:from-sky-600 hover:to-emerald-600 shadow-lg hover:shadow-xl"}
                `,children:O?(0,n.jsxs)(n.Fragment,{children:[n.jsx(u.Z,{className:"w-5 h-5 animate-spin"}),"Verifying..."]}):(0,n.jsxs)(n.Fragment,{children:[n.jsx(d.Z,{className:"w-5 h-5"}),"Verify OTP"]})}),(0,n.jsxs)("div",{className:"mt-6 text-center",children:[n.jsx("p",{className:"text-sm text-gray-500 mb-2",children:"Didn't receive the code?"}),n.jsx("button",{onClick:q,disabled:!S||L,className:`
                    inline-flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium
                    transition-all duration-200
                    ${S&&!L?"text-sky-600 hover:bg-sky-50":"text-gray-400 cursor-not-allowed"}
                  `,children:L?(0,n.jsxs)(n.Fragment,{children:[n.jsx(u.Z,{className:"w-4 h-4 animate-spin"}),"Sending..."]}):S?(0,n.jsxs)(n.Fragment,{children:[n.jsx(m.Z,{className:"w-4 h-4"}),"Resend OTP"]}):(0,n.jsxs)(n.Fragment,{children:[n.jsx(m.Z,{className:"w-4 h-4"}),"Resend in ",M,"s"]})})]})]})]})]})]})}},8668:(e,t,r)=>{"use strict";r.d(t,{Z:()=>d});var n=r(9899),s=r(5507),a=r(1963),l=r(2188),i=r(7577);let o=(0,s.forwardRef)(({label:e,value:t="",error:r,countryCode:o,onCountryCodeChange:d,onPhoneChange:c,disabled:u},m)=>{let[g,h]=(0,s.useState)(!1),[x,f]=(0,s.useState)(t),[p,y]=(0,s.useState)(),b=i.Qd.find(e=>e.code===o)||i.Qd[0];(0,s.useEffect)(()=>{f(t)},[t]);let D=e=>{d(e.code),h(!1),x.length>0&&y((0,i.BO)(x,e.code).error)},v=r||p;return(0,n.jsxs)("div",{className:"w-full",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5",children:e}),(0,n.jsxs)("div",{className:"relative flex",children:[(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsxs)("button",{type:"button",onClick:()=>!u&&h(!g),disabled:u,className:`flex items-center gap-1 px-3 py-3 rounded-l-lg border bg-gray-50 dark:bg-neutral-700 
                text-sm font-medium min-w-[90px] justify-between
                ${u?"opacity-50 cursor-not-allowed":"hover:bg-gray-100 dark:hover:bg-neutral-600"}
                ${v?"border-red-500 dark:border-red-600":"border-gray-300 dark:border-neutral-600 border-r-0"}`,children:[n.jsx("span",{className:"text-lg mr-1",children:b.flag}),n.jsx("span",{className:"text-neutral-700 dark:text-neutral-200",children:b.code}),n.jsx(a.Z,{className:"w-4 h-4 text-gray-500"})]}),g&&(0,n.jsxs)(n.Fragment,{children:[n.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>h(!1)}),n.jsx("div",{className:"absolute top-full left-0 mt-1 w-64 bg-white dark:bg-neutral-800 border border-gray-200    dark:border-neutral-600 rounded-lg shadow-lg z-20 max-h-60 overflow-y-auto",children:i.Qd.map(e=>(0,n.jsxs)("button",{type:"button",onClick:()=>D(e),className:`w-full flex items-center gap-3 px-3 py-2.5 text-left hover:bg-gray-100 
                        dark:hover:bg-neutral-700 text-sm transition-colors
                        ${e.code===o?"bg-primary-50 dark:bg-primary-900/30":""}`,children:[n.jsx("span",{className:"text-lg",children:e.flag}),n.jsx("span",{className:"flex-1 text-neutral-900 dark:text-neutral-100",children:e.country}),n.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:e.code})]},e.code))})]})]}),(0,n.jsxs)("div",{className:"relative flex-1",children:[n.jsx(l.Z,{className:"pointer-events-none absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{ref:m,type:"tel",value:x,onChange:e=>{let t=e.target.value.replace(/\D/g,"");f(t),c(t),t.length>0?y((0,i.BO)(t,o).error):y(void 0)},disabled:u,placeholder:`${b.minLength} digits`,maxLength:b.maxLength+5,className:`w-full rounded-r-lg border bg-white dark:bg-neutral-800 py-3 pl-10 pr-4 text-sm
                text-neutral-900 dark:text-neutral-100
                focus:outline-none focus:ring-2 transition-all
                ${u?"opacity-50 cursor-not-allowed bg-gray-100":""}
                ${v?"border-red-500 focus:ring-red-400 dark:border-red-600":"border-gray-300 dark:border-neutral-600 focus:ring-primary-500 focus:border-transparent"}`})]})]}),(0,n.jsxs)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:["Phone number should be ",b.minLength===b.maxLength?`${b.minLength} digits`:`${b.minLength}-${b.maxLength} digits`," for ",b.country]}),v&&n.jsx("p",{className:"mt-1 text-xs text-red-500",children:v})]})});o.displayName="PhoneInput";let d=o},5392:(e,t,r)=>{"use strict";r.d(t,{t:()=>a});var n=r(4978),s=r(1460);let a=(0,n.Ue)()((0,s.tJ)((e,t)=>({user:null,token:null,isAuthenticated:!1,isHydrated:!1,login:(t,r)=>{e({user:t,token:r,isAuthenticated:!0})},logout:()=>{e({user:null,token:null,isAuthenticated:!1})},updateUser:t=>e(e=>({user:e.user?{...e.user,...t}:null})),setHydrated:()=>e({isHydrated:!0})}),{name:"sangman-auth",storage:(0,s.FL)(()=>({getItem:()=>null,setItem:()=>{},removeItem:()=>{}})),onRehydrateStorage:()=>e=>{e&&e.setHydrated()}}))},1067:(e,t,r)=>{"use strict";r.d(t,{Bw:()=>x,Dn:()=>a,EY:()=>u,H3:()=>d,L:()=>m,N1:()=>i,o:()=>o,of:()=>h,sp:()=>l,tk:()=>c,yD:()=>g});let n=new Map,s={MAX_ATTEMPTS:5,WINDOW_MS:9e5,BLOCK_DURATION_MS:18e5,OTP_MAX_REQUESTS:3,OTP_WINDOW_MS:6e5};function a(e,t="login"){let r=Date.now(),a=n.get(`${t}:${e}`),l="otp"===t?s.OTP_MAX_REQUESTS:s.MAX_ATTEMPTS,i="otp"===t?s.OTP_WINDOW_MS:s.WINDOW_MS;if(!a)return n.set(`${t}:${e}`,{count:1,firstAttempt:r,lastAttempt:r,blocked:!1,blockedUntil:0}),{allowed:!0,remainingAttempts:l-1};if(a.blocked&&a.blockedUntil>r){let e=Math.ceil((a.blockedUntil-r)/6e4);return{allowed:!1,remainingAttempts:0,blockedUntil:a.blockedUntil,message:`Too many attempts. Try again in ${e} minutes.`}}if(r-a.firstAttempt>i||a.blocked&&a.blockedUntil<=r)return n.set(`${t}:${e}`,{count:1,firstAttempt:r,lastAttempt:r,blocked:!1,blockedUntil:0}),{allowed:!0,remainingAttempts:l-1};if(a.count++,a.lastAttempt=r,a.count>=l){a.blocked=!0,a.blockedUntil=r+s.BLOCK_DURATION_MS,n.set(`${t}:${e}`,a);let l=Math.ceil(s.BLOCK_DURATION_MS/6e4);return{allowed:!1,remainingAttempts:0,blockedUntil:a.blockedUntil,message:`Too many attempts. Account locked for ${l} minutes.`}}return n.set(`${t}:${e}`,a),{allowed:!0,remainingAttempts:l-a.count}}function l(e,t="login"){n.delete(`${t}:${e}`)}function i(e){return e?e.trim().replace(/<[^>]*>/g,"").replace(/[&<>"']/g,e=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"})[e]||e).replace(/(\b(SELECT|INSERT|UPDATE|DELETE|DROP|UNION|ALTER|CREATE|TRUNCATE)\b)/gi,"").replace(/(javascript:|data:|vbscript:)/gi,""):""}function o(e){return e.replace(/\D/g,"")}function d(e){return e?e.trim().toLowerCase():""}function c(){let e=new Uint8Array(32);for(let t=0;t<e.length;t++)e[t]=Math.floor(256*Math.random());return Array.from(e,e=>e.toString(16).padStart(2,"0")).join("")}function u(e){}function m(e){}function g(e){if(!e||e.length<6)return e;let t=e.slice(-4);return e.slice(0,-4).replace(/\d/g,"*")+t}function h(e){if(!e||!e.includes("@"))return e;let[t,r]=e.split("@");if(t.length<=2)return e;let n=t.slice(0,2)+"*".repeat(Math.min(t.length-2,5));return`${n}@${r}`}function x(e){}},7577:(e,t,r)=>{"use strict";r.d(t,{BO:()=>s,BP:()=>a,Qd:()=>n,f0:()=>l});let n=[{code:"+91",country:"India",minLength:10,maxLength:10,flag:"\uD83C\uDDEE\uD83C\uDDF3"},{code:"+1",country:"USA/Canada",minLength:10,maxLength:10,flag:"\uD83C\uDDFA\uD83C\uDDF8"},{code:"+44",country:"UK",minLength:10,maxLength:10,flag:"\uD83C\uDDEC\uD83C\uDDE7"},{code:"+971",country:"UAE",minLength:9,maxLength:9,flag:"\uD83C\uDDE6\uD83C\uDDEA"},{code:"+966",country:"Saudi Arabia",minLength:9,maxLength:9,flag:"\uD83C\uDDF8\uD83C\uDDE6"},{code:"+65",country:"Singapore",minLength:8,maxLength:8,flag:"\uD83C\uDDF8\uD83C\uDDEC"},{code:"+61",country:"Australia",minLength:9,maxLength:9,flag:"\uD83C\uDDE6\uD83C\uDDFA"},{code:"+49",country:"Germany",minLength:10,maxLength:11,flag:"\uD83C\uDDE9\uD83C\uDDEA"},{code:"+33",country:"France",minLength:9,maxLength:9,flag:"\uD83C\uDDEB\uD83C\uDDF7"},{code:"+81",country:"Japan",minLength:10,maxLength:10,flag:"\uD83C\uDDEF\uD83C\uDDF5"},{code:"+86",country:"China",minLength:11,maxLength:11,flag:"\uD83C\uDDE8\uD83C\uDDF3"},{code:"+977",country:"Nepal",minLength:10,maxLength:10,flag:"\uD83C\uDDF3\uD83C\uDDF5"},{code:"+880",country:"Bangladesh",minLength:10,maxLength:10,flag:"\uD83C\uDDE7\uD83C\uDDE9"},{code:"+92",country:"Pakistan",minLength:10,maxLength:10,flag:"\uD83C\uDDF5\uD83C\uDDF0"},{code:"+94",country:"Sri Lanka",minLength:9,maxLength:9,flag:"\uD83C\uDDF1\uD83C\uDDF0"}];function s(e,t){let r=n.find(e=>e.code===t);if(!r)return{valid:!1,error:"Invalid country code"};let s=e.replace(/\D/g,"");return s.length<r.minLength?{valid:!1,error:`Phone number must be at least ${r.minLength} digits for ${r.country}`}:s.length>r.maxLength?{valid:!1,error:`Phone number must be at most ${r.maxLength} digits for ${r.country}`}:/^\d+$/.test(s)?{valid:!0}:{valid:!1,error:"Phone number should only contain digits"}}function a(e,t){return e.replace(/\D/g,"")===t.replace(/\D/g,"")?{valid:!1,error:"Emergency contact phone must be different from your phone number"}:{valid:!0}}function l(e,t){let r=e.replace(/\D/g,"");return`${t}${r}`}},9714:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>n});let n=(0,r(2772).createProxy)(String.raw`C:\Users\Sangman\web\app\auth\error.tsx#default`)},3019:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>l});var n=r(5023),s=r(6745),a=r(1649);function l(){return n.jsx("div",{className:"min-h-screen bg-white dark:bg-slate-900 flex items-center justify-center p-4",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsxs)("div",{className:"flex items-center justify-center gap-2 mb-6",children:[n.jsx(s.Z,{className:"w-10 h-10 text-primary-500"}),n.jsx("span",{className:"text-2xl font-bold text-neutral-900 dark:text-neutral-100",children:"SANGMAN"})]}),n.jsx(a.Z,{className:"w-8 h-8 text-primary-500 animate-spin mx-auto mb-4"}),n.jsx("p",{className:"text-neutral-600 dark:text-neutral-400",children:"Preparing secure login..."})]})})}}};